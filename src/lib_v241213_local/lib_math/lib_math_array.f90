module lib_math_array
  implicit none
  private
  !-------------------------------------------------------------
  !
  !-------------------------------------------------------------
  public :: slice
  !-------------------------------------------------------------
  !
  !-------------------------------------------------------------
  interface slice
    module procedure slice__dble_2d
  end interface
!---------------------------------------------------------------
contains
!===============================================================
!
!===============================================================
function slice__dble_2d(a, d, i) result(b)
  implicit none
  real(8), intent(in) :: a(:,:)
  integer, intent(in) :: d
  integer, intent(in) :: i
  real(8) :: b(size(a,3-d))

  if( d == 1 )then
    b(:) = a(i,:)
  else
    b(:) = a(:,i)
  endif
end function slice__dble_2d
!===============================================================
!
!===============================================================
end module lib_math_array
